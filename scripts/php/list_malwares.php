<?php
// Path to directory containing malware
$malwareDirectory = '/var/www/html/Downloaded/malware_upload/';

// Open directory
$dir = new DirectoryIterator($malwareDirectory);

$output = "<table class='malwaretable'>";
$output .= "<thead><tr><th>File Name</th><th>Size</th><th>Type</th><th>Creation date</th><th>Action</th></tr></thead><tbody>";


foreach ($dir as $fileinfo) {
    if (!$fileinfo->isDot()) {
     
        $filename = $fileinfo->getFilename();

        $filesize = $fileinfo->getSize();
        $sizes = array('B', 'KB', 'MB', 'GB', 'TB');
        $factor = floor((strlen($filesize) - 1) / 3);
        $humanFileSize = sprintf("%.2f", $filesize / pow(1024, $factor)) . @$sizes[$factor];
        
        $fileExtension = $fileinfo->getExtension();

        $fileCreationDate = date("F d Y H:i:s.", $fileinfo->getMTime());

        $output .= "<tr>";
        $output .= "<td>{$filename}</td>";
        $output .= "<td>{$humanFileSize}</td>";
        $output .= "<td>{$fileExtension}</td>";
        $output .= "<td>{$fileCreationDate}</td>";
        $output .= "<td><button class='runMalware' data-filename='{$filename}'>Run</button></td>";
        $output .= "</tr>";
    }
}

$output .= "</tbody></table>";

echo $output;
?>

